<!DOCTYPE html>
<html>
<head>
    <title>Test Google Sheets Connection</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        .code { background: #f5f5f5; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Google Sheets Connection Test</h1>
    <button onclick="testConnection()">Test Connection</button>
    <div id="result"></div>

    <script>
        async function testConnection() {
            const result = document.getElementById('result');
            result.innerHTML = 'Testing...';
            
            try {
                const response = await fetch('http://localhost:3001/api/test-sheets/test-connection');
                const data = await response.json();
                
                if (data.status === 'success') {
                    result.innerHTML = `
                        <div class="success">
                            <h3>✅ Connection Successful!</h3>
                            <p><strong>Sheet:</strong> ${data.sheetTitle}</p>
                            <p><strong>Worksheet:</strong> ${data.worksheetTitle}</p>
                            <p><strong>Headers:</strong> ${data.headers.join(', ')}</p>
                            <p><strong>Total Rows:</strong> ${data.totalRows}</p>
                            <div class="code">
                                <strong>Sample Data:</strong><br>
                                ${data.sampleRows.map(row => row.join(' | ')).join('<br>')}
                            </div>
                        </div>
                    `;
                } else {
                    result.innerHTML = `
                        <div class="error">
                            <h3>❌ Connection Failed</h3>
                            <p><strong>Error:</strong> ${data.message}</p>
                            <h4>Instructions:</h4>
                            <ul>
                                ${data.instructions.map(inst => `<li>${inst}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
            } catch (error) {
                result.innerHTML = `<div class="error">Network Error: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>